-- fetchCustomer.sql
SELECT
  u.ID AS id,
  u.user_login AS username,
  u.user_email AS email,
  u.display_name AS displayName,
  um_first.meta_value AS firstName,
  um_last.meta_value AS lastName,
  um_phone.meta_value AS phone,
  u.user_registered AS dateRegistered,
  um_lastActive.meta_value AS lastActive,
  um_city.meta_value AS city,
  um_state.meta_value AS state,
  um_country.meta_value AS country
FROM wp_users u
LEFT JOIN wp_usermeta um_first 
  ON u.ID = um_first.user_id AND um_first.meta_key = 'first_name'
LEFT JOIN wp_usermeta um_last 
  ON u.ID = um_last.user_id AND um_last.meta_key = 'last_name'
LEFT JOIN wp_usermeta um_phone 
  ON u.ID = um_phone.user_id AND um_phone.meta_key = 'phone'
LEFT JOIN wp_usermeta um_lastActive 
  ON u.ID = um_lastActive.user_id AND um_lastActive.meta_key = 'last_active'
LEFT JOIN wp_usermeta um_city 
  ON u.ID = um_city.user_id AND um_city.meta_key = 'city'
LEFT JOIN wp_usermeta um_state 
  ON u.ID = um_state.user_id AND um_state.meta_key = 'state'
LEFT JOIN wp_usermeta um_country 
  ON u.ID = um_country.user_id AND um_country.meta_key = 'country'
ORDER BY u.user_registered DESC;
